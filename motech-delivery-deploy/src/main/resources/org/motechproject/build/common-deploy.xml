<?xml version="1.0" encoding="UTF-8"?>
<antlib>

    <typedef resource="org/motechproject/build/activemq.xml"/>
    <typedef resource="org/motechproject/build/couchdb.xml"/>
    <typedef resource="org/motechproject/build/env.xml"/>
    <typedef resource="org/motechproject/build/hudson.xml"/>
    <typedef resource="org/motechproject/build/mysql.xml"/>
    <typedef resource="org/motechproject/build/nexus.xml"/>
    <typedef resource="org/motechproject/build/seed.xml"/>
    <typedef resource="org/motechproject/build/tomcat.xml"/>

    <macrodef name="download.app.from.remote">
        <attribute name="app.name"/>
        <attribute name="remote.location"/>
        <attribute name="download.dir"/>
        <sequential>
            <copy tofile="@{download.dir}/@{app.name}.war" flatten="true" overwrite="true">
                <resources>
                    <url url="@{remote.location}"/>
                </resources>
            </copy>
        </sequential>
    </macrodef>

    <macrodef name="start.slave">
        <attribute name="activemq.home"/>
        <attribute name="activemq.port"/>
        <attribute name="couch.db.port"/>
        <attribute name="tomcat.home"/>
        <attribute name="tomcat.port"/>
        <sequential>
            <start.activemq activemq.home="@{activemq.home}" activemq.port="@{activemq.port}"/>
            <start.couch.db couch.db.port="@{couch.db.port}"/>
            <start.mysql/>
            <start.tomcat tomcat.home="@{tomcat.home}" tomcat.port="@{tomcat.port}"/>
        </sequential>
    </macrodef>

    <macrodef name="stop.slave">
        <attribute name="tomcat.home"/>
        <attribute name="tomcat.port"/>
        <sequential>
            <stop.tomcat tomcat.home="@{tomcat.home}" tomcat.port="@{tomcat.port}"/>
        </sequential>
    </macrodef>
</antlib>
